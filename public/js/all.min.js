(function(d,f){function a(){throw new Error("Abstract function ")}function c(i,h){if(typeof i==="string"){i=d.document.getElementById(i);if(!i){throw new Error("Cant found player element with id "+i)}}this.getPlayer=function(){return i};h=h||{};h.files=h.files||[];this.options=h;var j=0,g=false;this.getCurrentFileIndex=function(){return j};this.setCurrentFileIndex=function(k){k=parseInt(k,10)||0;if(k<0||k>h.files.length){k=0}j=k;return this};this.getCurrentFile=function(){var k=this.options.files[this.getCurrentFileIndex()];if(!k){throw Error("File #"+this.getCurrentFileIndex()+" does not exists")}return k};this.inPlay=function(k){return arguments.length?(g=!!k):(g)}}c.prototype.getOptions=function(){return this.options};c.prototype.getOption=function(g){return this.options[g]};c.prototype.setOption=function(g,h){this.options[g]=h;return this};c.prototype.play=a;c.prototype.stop=a;c.prototype.pause=a;c.prototype.next=a;c.prototype.prev=a;c.prototype.getVolume=a;c.prototype.setVolume=a;c.prototype.toNext=function(){var g=this.getCurrentFileIndex()||0;g++;if(g===this.getOption("files").length){g=0}this.setCurrentFileIndex(g)};c.prototype.toPrev=function(){var g=this.getCurrentFileIndex()||0;g--;if(g<0){g=this.getOption("files").length-1}this.setCurrentFileIndex(g)};c.prototype.addFile=function(g){this.options.push(g);return this};function e(i,h){this.parent.apply(this,arguments);var g=this;var j=this.getPlayer();d.jQuery(j).on("play",function(){g.onStartPlay()});d.jQuery(j).on("canplaythrough",function(){g.onPlay()})}e.prototype=new c();e.prototype.parent=c;e.prototype.constructor=e;e.isSupport=function(){if(d.Audio!==f){try{new d.Audio();return true}catch(g){}}return false};e.isSupportFormat=function(j){var h=false;if(e.isSupport()){j=j.toLowerCase();var g={ogg:"audio/ogg;",mp3:"audio/mpeg;"};var i=new d.Audio();h=(g[j]&&!!i.canPlayType(g[j]))}return h};e.prototype.play=function(){var g=this.getCurrentFile();this.getPlayer().setAttribute("src",g);this.getPlayer().play();this.inPlay(true)};e.prototype.stop=function(){this.getPlayer().pause();this.inPlay(false)};e.prototype.next=function(){this.toNext();if(this.inPlay()){this.play()}return this};e.prototype.prev=function(){this.toPrev();if(this.inPlay()){this.play()}};e.prototype.setVolume=function(g){if(g<0||g>100){return false}this.getPlayer().volume=g/100;return this};e.prototype.onStartPlay=function(){if(typeof this.options.onStartPlay==="function"){this.options.onStartPlay()}};e.prototype.onPlay=function(){if(typeof this.options.onPlay==="function"){this.options.onPlay()}};function b(h,g){this.parent.apply(this,arguments)}b.prototype=new c();b.prototype.parent=c;b.prototype.constructor=b;b.prototype.send=function(g){try{uppodSend(this.getPlayer().id,g)}catch(h){console.warn(h)}return this};b.prototype.play=function(){var g=this.getCurrentFile();this.send("file:"+g);this.inPlay(true)};b.prototype.stop=function(){this.send("stop");this.inPlay(false)};b.prototype.next=function(){this.toNext();if(this.inPlay()){this.play()}return this};b.prototype.prev=function(){this.toPrev();if(this.inPlay()){this.play()}};b.prototype.setVolume=function(g){if(g<0||g>100){return false}return this.send("v"+g)};d.BasePlayer=c;d.Html5Player=e;d.UppodPlayer=b})(window);function uppodEvent(a,b){switch(b){case"init":break;case"start":break;case"play":break;case"pause":break;case"stop":break;case"seek":break;case"loaded":break;case"end":break;case"download":break;case"quality":break;case"error":break;case"ad_end":break;case"pl":break}}function uppodSend(b,a,c){document.getElementById(b).sendToUppod(a)}function uppodGet(b,a,c){return document.getElementById(b).getUppod(a)}(function(b,d){function c(f){var e="http://ws.audioscrobbler.com/2.0/";this.request=function(h,i,g){h=h||{};if(h.method===d){throw new Error("method is undefined")}h.api_key=h.api_key||f;h.format=h.format||"json";$.ajax({url:e,crossDomain:true,dataType:"jsonp",data:h,success:i,error:g})}}function a(f){var e=new c(f);this.getClient=function(){return e}}a.prototype.getRecentTracks=function(f,g,e){if(f.user===d){throw new Error("User is undefined")}f.method="user.getrecenttracks";f.limit=f.limit||1;this.getClient().request(f,g,e)};b.LastFm=a})(window);(function(){var a=new Date("2011-06-02T09:34:29+02:00");if(!a||+a!==1307000069000){Date.fromISO=function(e){var c,h,g=/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*)?)([zZ]|([+\-])(\d\d):(\d\d))?$/,f=g.exec(e)||[];if(f[1]){c=f[1].split(/\D/);for(var d=0,b=c.length;d<b;d++){c[d]=parseInt(c[d],10)||0}c[1]-=1;c=new Date(Date.UTC.apply(Date,c));if(!c.getDate()){return NaN}if(f[5]){h=(parseInt(f[5],10)*60);if(f[6]){h+=parseInt(f[6],10)}if(f[4]==="+"){h*=-1}if(h){c.setUTCMinutes(c.getUTCMinutes()+h)}}return c}return NaN}}else{Date.fromISO=function(b){return new Date(b)}}})();(function(j,f){var e=j.jQuery;var s=new LastFm("c7cf555ada3061e1a0fe8b258185d6d9");var t=e("#track-searcher .tab-button.search:first");var g=e("#track-searcher .wrapper");var b=e(".form:first",g);var l=e("ul.list:first",g);t.click(function(){t.hide();g.slideDown()});var r=e("p.buttons a.day-button",b);r.click(function(){var w=e(this);r.removeClass("selected");w.addClass("selected");i(w.attr("data-day"));return false});var o=e("p.buttons a.close:first");o.click(function(){p(true);g.slideUp(function(){t.show()})});var c={date:e(".inputs input.date:first"),time:e(".inputs input.time:first"),search:e(".inputs input.submit:first")};i("today",true);c.search.on("click",n);c.date.on("keypress",u);c.time.on("keypress",u);function u(w){if(w.keyCode===13){n()}}function n(){var w=trim(c.date.val());w=w.split(/[^\d]/).reverse();if(w.length<3){alert("Неверный формат даты. Введите в виде дд.мм.гг")}w[1]=h(w[1],2);w[2]=h(w[2],2);if(w[0].length<4){w[0]="20"+w[0]}w=w.join("-");var y=trim(c.time.val());y=y.split(/[^\d]/);if(y.length<2){alert("Неверный формат времени. Введите в виде чч:мм")}y[0]=h(y[0],2);y=y.concat(["00"]).join(":");var x=Date.fromISO(w+"T"+y+a());if(isNaN(+x)){alert("Ошибочная дата. Повнимательнее.");return false}p(true);d(x)}function d(w){var x=parseInt((+w)/1000,10);var y=10*60;s.getRecentTracks({user:"radiorostova",from:x-y,to:x+y,limit:5},function(A){var z;try{z=A.recenttracks.track}catch(B){z=[]}m(z,x)},function(){})}function m(G,E){G=G||[];var C=G.length;if(C<1){return v()}p();var B,w,F="",A=E,D=null,H,z;for(B=0;B<C;B++){w=G[B];var x=new Date();x.setSeconds(0);if(w.date){z=parseInt(w.date.uts,10);x.setTime((z)*1000);x.setSeconds(0)}else{continue}z=parseInt(x/1000,10);H="";if(!D&&A>=z){H="target";D=true}var y='<li class="track '+H+'"><img class="poster" src="'+w.image[0]["#text"]+'"><div class="info"><a class="name" target="_blank" href="'+w.url+'">'+w.name+'</a><a class="artist" target="_blank" href="'+w.url+'">'+w.artist["#text"]+'</a><div class="dt"><span class="time">'+q(x)+'</span><br><span class="date"> '+k(x)+'</span></div></div><div class="clear"></div></li>';F=y+F}l.html(F).slideDown()}function p(w){if(w){l.hide()}l.empty()}function v(){p();l.html("К сожалению ничего не найдено");l.slideDown()}function i(z,w){z=z||"today";if(!{today:1,yesterday:1,other:1}[z]){return false}var x=new Date();var y=null;switch(z){case"yesterday":x.setDate(x.getDate()-1);y=true;break;case"today":y=true;break;default:c.date[0].focus();c.date[0].select()}c.date.attr("disabled",y);var A=k(x);c.date.val(A);if(w){x.setMinutes(0);A=q(x);c.time.val(A)}}function q(w){return[h(w.getHours(),2),h(w.getMinutes(),2)].join(":")}function k(w){return[h(w.getDate(),2),h(w.getMonth()+1,2),String(w.getFullYear()).replace(/^(\d){2}/,"")].join(".")}function a(){var x=new Date().getTimezoneOffset()/60;var w=(x<0)?"+":"-";x=String(Math.abs(x));if(x.length<2){x="0"+x}return w+x+":00"}function h(y,x){x=Number(x);var w=String(y);if(x&&w.length<x){w=(new Array(x-w.length+1)).join("0")+y}return w}}(window));(function(d,g){var e,f,c;var b=Number(getCookie("search-helper"));if(!b){e=d.jQuery;f=e("#hand-pointer");c=e("#track-searcher .tab-button.search:first");c.click(function(){if(!b){b=true;var h=new Date();h.setFullYear(h.getFullYear()+1);setCookie("search-helper",1,{expires:h});f.remove()}});f.show();a(false)}function a(h){if(b){return}f.animate({left:(h?"+":"-")+"=20"},{duration:500,complete:function(){a(!h)}})}})(window);(function(i,c){var b=null;var f=i.jQuery;var d=i.location;var h=f(i);var m=d.protocol+"//"+d.host+":6789";var k=io.connect(m);k.on("trackUpdate",function(l){b=g(l);if(!b){return false}h.trigger("trackUpdate",b);a(b)});var e=f("#rr-player .track");var j={name:f("span.name",e),artist:f("span.artist",e),coverLinks:f("#rr-player .track a.track-link, #cover-link"),coverImage:f("#cover-image")};function a(l){if(l.artist&&l.name){j.name.html(l.name);j.artist.html(l.artist);j.coverLinks.attr("href",l.url);j.coverImage.attr("src",l.image)}}function g(l){var o;try{o=l.image[2]["#text"]}catch(n){}o=o||"images/player/poster.jpg";return{name:l.name||null,artist:l.artist||null,url:l.url||null,image:o}}})(window);(function(h,d){var f=h.jQuery,c;var e=f("#like");var j=e.children(".target.facebook:first");var k=e.children(".target.vkontakte:first");var b=e.children(".target.twitter:first");if(isTouchDevice()){e.addClass("touch");e.on("click",function(){e.addClass("touched");return false});c=function(l){l.stopPropagation();e.removeClass("touched")};j.on("click",c);k.on("click",c);b.on("click",c);f(document).on("click",c)}f(h).on("trackUpdate",function(n,l){if(l.artist==="Радио Ростова на 101.6 FM"||l.artist==="Радио Ростова"){e.hide()}else{var m=f.extend({},l);m.text='Я слушаю "'+m.artist+" - "+m.name+'" на Радио Ростова';m.url="http://live.radiorostov.ru";g(m);i(m);a(m);e.show()}});function g(m){var l="http://www.facebook.com/sharer/sharer.php?s=100&p[title]=Радио Ростова 101.6 FM&p[summary]="+encodeURIComponent(m.text)+"&p[url]="+encodeURIComponent(m.url)+"&p[images][0]="+encodeURIComponent(m.image);j.attr("href",l)}function i(m){var l="http://vk.com/share.php?url="+encodeURIComponent(m.url)+"&description="+encodeURIComponent(m.text)+"&title=Радио Ростова 101.6 FM&image="+encodeURIComponent(m.image)+"&noparse=true";k.attr("href",l)}function a(m){var n='#nowlistening "'+m.artist+" - "+m.name+'" on @radiorostova';var l="http://twitter.com/home?status="+encodeURIComponent(n)+" - "+encodeURIComponent(m.url);b.attr("href",l)}})(window);(function(f,c){var e=f.$;var i=["http://live.radiorostov.ru:8000/rostovradio","http://live.radiorostov.ru:8000/rostovradiofm","http://178.76.238.182:8000/rostovradio","http://178.76.238.182:8000/rostovradiofm","http://81.19.85.204:80/rostov.mp3"],a=0;var h;if(Html5Player.isSupportFormat("mp3")){h=new Html5Player((new Audio()),{files:i,onStartPlay:function(){},onPlay:function(){}});b()}else{if(d()){f.uppodEvent=function(j,k){if(k==="init"){b()}};var g=e('<object width="400" height="60" type="application/x-shockwave-flash" data="swf/uppod-audio.swf" id="rrplayer" style="visibility: visible;"><param name="movie" value="swf/uppod-audio.swf"><param name="id" value="rrplayer"><param name="allowScriptAccess" value="always"><param name="flashvars" value="uid=rrplayer&amp;st=/swf/youtube.txt&amp;file=http%3A%2F%2Flive.radiorostov.ru%3A8000%2Frostovradiofm"></object>');e(g).appendTo(e("#rr-player-c"));h=new UppodPlayer(g[0],{files:i})}else{e("#rr-player").addClass("no-flash")}}function b(){var o=r();var t=m(f.$);t.play.click(v);t.prev.mousedown(w);t.next.mousedown(k);t.stop.mousedown(p);t.volume.progress.on("mousemove mousedown",function(A){if(A.type==="mousedown"){this.mousedown=true}if(!this.mousedown){return false}var x=e(this);this.width=this.width||(this.width=x.innerWidth());var z=A.clientX-x.offset().left;var y=Math.round(z/this.width*100);s(y)});e(document).on("mouseup",function(){t.volume.progress[0].mousedown=false});s(o,true);function m(z){var x=z("#rr-player .track-info");var y={};y.volume={progress:z(".volume .progress",x),slider:z(".volume .progress .slider",x),value:z(".volume .value",x)};y.buttons=z(".controls",x);y.play=z(".button.play",x);y.prev=z(".button.prev",x);y.next=z(".button.next",x);y.stop=z(".button.pause",x);y.stream=z(".stream-info .stream-index");y.url=z(".stream-info .url");return y}function s(x,y){if(x!==o||y){t.volume.slider.css("width",x+"%");t.volume.value.text(x+"%");o=x;h.setVolume(o);n(o)}}function v(){h.play();t.buttons.addClass("inplay")}function w(){h.prev();u(t.prev);j()}function k(){h.next();u(t.next);j()}function p(){h.stop();u(t.stop);t.buttons.removeClass("inplay")}function u(x){x.addClass("vc-control-active");f.setTimeout(function(){x.removeClass("vc-control-active")},200)}function j(){t.stream.text("#"+(h.getCurrentFileIndex()+1));t.url.attr("href",h.getCurrentFile()+".m3u").text(h.getCurrentFile())}function r(){var x=parseInt(getCookie("playerVolume"),10);if(isNaN(x)||x<0||x>100){x=50}return x}var q;var l=new Date();function n(x){if(q){f.clearTimeout(q);q=null}q=f.setTimeout(function(){setCookie("playerVolume",x,{expires:(new Date()).setFullYear(l.getFullYear()+1)})},25)}h.setCurrentFileIndex(a);j()}function d(){var j=false;try{var k=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(k){j=true}}catch(l){if(navigator.mimeTypes["application/x-shockwave-flash"]!==c){j=true}}return !!j}})(window);(function(a,c){var b=a.$;if(typeof(b)==="function"){b(function(){if(typeof(VK)!=="undefined"){var e="http://live.radiorostov.ru/",d=0;VK.init({apiId:2859319,onlyWidgets:true});VK.Widgets.Like("vk_like",{type:"mini",height:18,pageUrl:e});VK.Widgets.Comments("vk_comments",{limit:10,width:"500",attach:"*"},d)}})}})(window);function trim(a){if(typeof(a)!=="string"){return a}return a.replace(/^\s+|\s+$/g,"")}function getCookie(a){var b=document.cookie.match(new RegExp("(?:^|; )"+a.replace(/([\.$?*|{}\(\)\[\]\\\/\+\^])/g,"\\$1")+"=([^;]*)"));return b?decodeURIComponent(b[1]):undefined}function setCookie(b,f,c){c=c||{};var i=c.expires;if(typeof i==="number"&&i){var h=new Date();h.setTime(h.getTime()+i*1000);i=c.expires=h}if(i&&i.toUTCString){c.expires=i.toUTCString()}f=encodeURIComponent(f);var a=b+"="+f;var e;for(e in c){if(c.hasOwnProperty(e)){a+="; "+e;var g=c[e];if(g!==true){a+="="+g}}}window.document.cookie=a}function isTouchDevice(){return !!("ontouchstart" in document.documentElement)};