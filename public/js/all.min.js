(function(d,f){function a(){throw new Error("Abstract function ");}function c(i,h){if(typeof i==="string"){i=d.document.getElementById(i);if(!i){throw new Error("Cant found player element with id "+i);}}this.getPlayer=function(){return i;};h=h||{};h.files=h.files||[];this.options=h;var j=0,g=false;this.getCurrentFileIndex=function(){return j;};this.setCurrentFileIndex=function(k){k=parseInt(k,10)||0;if(k<0||k>h.files.length){k=0;}j=k;return this;};this.getCurrentFile=function(){var k=this.options.files[this.getCurrentFileIndex()];if(!k){throw Error("File #"+this.getCurrentFileIndex()+" does not exists");}return k;};this.inPlay=function(k){return arguments.length?(g=!!k):(g);};}c.prototype.getOptions=function(){return this.options;};c.prototype.getOption=function(g){return this.options[g];};c.prototype.setOption=function(g,h){this.options[g]=h;return this;};c.prototype.play=a;c.prototype.stop=a;c.prototype.pause=a;c.prototype.next=a;c.prototype.prev=a;c.prototype.getVolume=a;c.prototype.setVolume=a;c.prototype.toNext=function(){var g=this.getCurrentFileIndex()||0;g++;if(g===this.getOption("files").length){g=0;}this.setCurrentFileIndex(g);};c.prototype.toPrev=function(){var g=this.getCurrentFileIndex()||0;g--;if(g<0){g=this.getOption("files").length-1;}this.setCurrentFileIndex(g);};c.prototype.addFile=function(g){this.options.push(g);return this;};function e(i,h){this.parent.apply(this,arguments);var g=this;var j=this.getPlayer();d.jQuery(j).on("play",function(){g.onStartPlay();});d.jQuery(j).on("canplaythrough",function(){g.onPlay();});}e.prototype=new c();e.prototype.parent=c;e.prototype.constructor=e;e.isSupport=function(){if(d.Audio!==f){try{new d.Audio();return true;}catch(g){}}return false;};e.isSupportFormat=function(j){var h=false;if(e.isSupport()){j=j.toLowerCase();var g={ogg:"audio/ogg;",mp3:"audio/mpeg;"};var i=new d.Audio();h=(g[j]&&!!i.canPlayType(g[j]));}return h;};e.prototype.play=function(){var g=this.getCurrentFile();this.getPlayer().setAttribute("src",g);this.getPlayer().play();this.inPlay(true);};e.prototype.stop=function(){this.getPlayer().pause();this.inPlay(false);};e.prototype.next=function(){this.toNext();if(this.inPlay()){this.play();}return this;};e.prototype.prev=function(){this.toPrev();if(this.inPlay()){this.play();}};e.prototype.setVolume=function(g){if(g<0||g>100){return false;}this.getPlayer().volume=g/100;return this;};e.prototype.onStartPlay=function(){if(typeof this.options.onStartPlay==="function"){this.options.onStartPlay();}};e.prototype.onPlay=function(){if(typeof this.options.onPlay==="function"){this.options.onPlay();}};function b(h,g){this.parent.apply(this,arguments);}b.prototype=new c();b.prototype.parent=c;b.prototype.constructor=b;b.prototype.send=function(g){try{uppodSend(this.getPlayer().id,g);}catch(h){console.warn(h);}return this;};b.prototype.play=function(){var g=this.getCurrentFile();this.send("file:"+g);this.inPlay(true);};b.prototype.stop=function(){this.send("stop");this.inPlay(false);};b.prototype.next=function(){this.toNext();if(this.inPlay()){this.play();}return this;};b.prototype.prev=function(){this.toPrev();if(this.inPlay()){this.play();}};b.prototype.setVolume=function(g){if(g<0||g>100){return false;}return this.send("v"+g);};b.createPlayerObject=function(i){i=i||{};i.width=i.width||1;i.height=i.height||1;i["arguments"]=i["arguments"]||{};h(i);var g=("\v"=="v"),m=(g)?l(i.movie):document.createElement("object");if(!g){m.setAttribute("type","application/x-shockwave-flash");m.setAttribute("data",i.movie);}m.setAttribute("id",i.id);m.setAttribute("width",i.width);m.setAttribute("height",i.height);var j=document.createElement("param");j.setAttribute("name","flashvars");j.setAttribute("value",k(i["arguments"]));m.appendChild(j);document.body.appendChild(m);return m;function l(n){var o=document.createElement("div");o.innerHTML="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'><param name='movie' value='"+n+"'></object>";return o.firstChild;}function h(n){if(!n.movie){throw Error("options.movie does not exist");}if(!n.id){throw Error("options.id does not exist");}}function k(p){p=p||{};var o=[];var n;for(n in p){if(p.hasOwnProperty(n)){o.push(n+"="+p[n]);}}return o.join("&");}};d.BasePlayer=c;d.Html5Player=e;d.UppodPlayer=b;})(window);function uppodEvent(a,b){switch(b){case"init":break;case"start":break;case"play":break;case"pause":break;case"stop":break;case"seek":break;case"loaded":break;case"end":break;case"download":break;case"quality":break;case"error":break;case"ad_end":break;case"pl":break;}}function uppodSend(b,a,c){document.getElementById(b).sendToUppod(a);}function uppodGet(b,a,c){return document.getElementById(b).getUppod(a);}(function(b,d){function c(f){var e="http://ws.audioscrobbler.com/2.0/";this.request=function(h,i,g){h=h||{};if(h.method===d){throw new Error("method is undefined");}h.api_key=h.api_key||f;h.format=h.format||"json";$.ajax({url:e,crossDomain:true,dataType:"jsonp",data:h,success:i,error:g});};}function a(f){var e=new c(f);this.getClient=function(){return e;};}a.prototype.getRecentTracks=function(f,g,e){if(f.user===d){throw new Error("User is undefined");}f.method="user.getrecenttracks";f.limit=f.limit||1;this.getClient().request(f,g,e);};b.LastFm=a;})(window);(function(h,f){var e=h.jQuery;var q=new LastFm("c7cf555ada3061e1a0fe8b258185d6d9");var r=e("#track-searcher .tab-button.search:first");var g=e("#track-searcher .wrapper");var b=e(".form:first",g);var k=e("ul.list:first",g);r.click(function(){r.hide();g.slideDown();});var o=e("p.buttons a.day-button",b);o.click(function(){var t=e(this);o.removeClass("selected");t.addClass("selected");i(t.attr("data-day"));return false;});var m=e("p.buttons a.close:first");m.click(function(){n(true);g.slideUp(function(){r.show();});});var c={date:e(".inputs input.date:first"),time:e(".inputs input.time:first"),search:e(".inputs input.submit:first")};i("today",true);c.search.click(function(){n(true);var t=c.date.val();t=t.split(".").reverse();if(t[0].length<4){t[0]="20"+t[0];}t=t.join("-");var v=c.time.val();v=v.split(":");if(!v.length){alert("Неверный формат времени. Введите в виде чч:мм");}if(v[0].length===1){v[0]="0"+v[0];}v=v.concat(["00"]).join(":");var u=new Date(t+"T"+v+a());if(isNaN(+u)){alert("Ошибочная дата. Повнимательнее.");return false;}d(u);});function d(t){var u=parseInt((+t)/1000,10);var v=10*60;q.getRecentTracks({user:"radiorostova",from:u-v,to:u+v,limit:5},function(x){var w;try{w=x.recenttracks.track;}catch(y){w=[];}l(w,u);},function(){});}function l(D,B){D=D||[];var z=D.length;if(z<1){return s();}n();var y,t,C="",x=B,A=null,E,w;for(y=0;y<z;y++){t=D[y];var u=new Date();u.setSeconds(0);if(t.date){w=parseInt(t.date.uts,10);u.setTime((w)*1000);u.setSeconds(0);}else{continue;}w=parseInt(u/1000,10);E="";if(!A&&x>=w){E="target";A=true;}var v='<li class="track '+E+'"><img class="poster" src="'+t.image[0]["#text"]+'"><div class="info"><a class="name" target="_blank" href="'+t.url+'">'+t.name+'</a><a class="artist" target="_blank" href="'+t.url+'">'+t.artist["#text"]+'</a><div class="dt"><span class="time">'+p(u)+'</span><br><span class="date"> '+j(u)+'</span></div></div><div class="clear"></div></li>';C=v+C;}k.html(C).slideDown();}function n(t){if(t){k.hide();}k.empty();}function s(){n();k.html("К сожалению ничего не найдено");k.slideDown();}function i(w,t){w=w||"today";if(!{today:1,yesterday:1,other:1}[w]){return false;}var u=new Date();var v=null;switch(w){case"yesterday":u.setDate(u.getDate()-1);v=true;break;case"today":v=true;break;default:c.date[0].focus();c.date[0].select();}c.date.attr("disabled",v);var x=j(u);c.date.val(x);if(t){u.setMinutes(0);x=p(u);c.time.val(x);}}function p(t){return[String(t.getHours()).replace(/^(\d){1}$/,"0$1"),String(t.getMinutes()).replace(/^(\d){1}$/,"0$1")].join(":");}function j(t){return[String(t.getDate()).replace(/^(\d){1}$/,"0$1"),t.getMonth()+1,String(t.getFullYear()).replace(/^(\d){2}/,"")].join(".");}function a(){var u=new Date().getTimezoneOffset()/60;var t=(u<0)?"+":"-";u=String(Math.abs(u));if(u.length<2){u="0"+u;}return t+u+":00";}}(window));(function(h,c){var b=null;var f=h.jQuery;var d=h.location;var k=d.protocol+"//"+d.host+":6789";var j=io.connect(k);j.on("trackUpdate",function(l){b=g(l);if(!b){return false;}a(b);});var e=f("#rr-player .track");var i={name:f("span.name",e),artist:f("span.artist",e),coverLinks:f("#rr-player .track a.track-link, #cover-link"),coverImage:f("#cover-image")};function a(l){if(l.artist&&l.name){i.name.html(l.name);i.artist.html(l.artist);i.coverLinks.attr("href",l.url);i.coverImage.attr("src",l.image);}}function g(l){var n;try{n=l.image[2]["#text"];}catch(m){}n=n||"images/player/poster.jpg";return{name:l.name||null,artist:l.artist||null,url:l.url||null,image:n};}})(window);(function(c,f){var d=c.$;var h=["http://live.radiorostov.ru:8000/rostovradio","http://zavalinka.in:8000/rostovradio","http://178.76.238.182:8000/rostovradio","http://zavalinka.in:8000/rostovradiofm","http://178.76.238.182:8000/rostovradiofm","http://81.19.85.204:80/rostov.mp3"];var b;if(Html5Player.isSupportFormat("mp3")){b=new Html5Player((new Audio()),{files:h,onStartPlay:function(){},onPlay:function(){}});e();}else{if(a()){var g=UppodPlayer.createPlayerObject({movie:"swf/uppod-audio.swf",id:"player","arguments":{uid:"player",file:"http%3A%2F%2Fzavalinka.in%3A8000%2Frostovradio",st:"/swf/youtube.txt"}});g.style.visibility="hidden";b=new UppodPlayer(g,{files:h});c.uppodEvent=function(i,j){if(j==="init"){e();}};}else{d("#rr-player").addClass("no-flash");}}function e(){var n=r();var t=l(c.$);t.play.click(w);t.prev.mousedown(x);t.next.mousedown(j);t.stop.mousedown(o);t.volume.progress.on("mousemove mousedown",function(B){if(B.type==="mousedown"){this.mousedown=true;}if(!this.mousedown){return false;}var y=d(this);this.width=this.width||(this.width=y.innerWidth());var A=B.clientX-y.offset().left;var z=Math.round(A/this.width*100);s(z);});d(document).on("mouseup",function(){t.volume.progress[0].mousedown=false;});s(n,true);function l(A){var y=A("#rr-player .track-info");var z={};z.volume={progress:A(".volume .progress",y),slider:A(".volume .progress .slider",y),value:A(".volume .value",y)};z.buttons=A(".controls",y);z.play=A(".button.play",y);z.prev=A(".button.prev",y);z.next=A(".button.next",y);z.stop=A(".button.pause",y);z.stream=A(".stream-info .stream-index");z.url=A(".stream-info .url");return z;}function s(y,z){if(y!==n||z){t.volume.slider.css("width",y+"%");t.volume.value.text(y+"%");b.setVolume(n);n=y;m(n);}}function w(){b.play();t.buttons.addClass("inplay");}function x(){b.prev();v(t.prev);i();}function j(){b.next();v(t.next);i();}function o(){b.stop();v(t.stop);t.buttons.removeClass("inplay");}function v(y){y.addClass("vc-control-active");c.setTimeout(function(){y.removeClass("vc-control-active");},200);}function i(){t.stream.text("#"+(b.getCurrentFileIndex()+1));t.url.attr("href",b.getCurrentFile()+".m3u").text(b.getCurrentFile());}function q(y){var z=document.cookie.match(new RegExp("(?:^|; )"+y.replace(/([\.$?*|{}\(\)\[\]\\\/\+\^])/g,"\\$1")+"=([^;]*)"));return z?decodeURIComponent(z[1]):f;}function u(z,C,A){A=A||{};var F=A.expires;if(typeof F==="number"&&F){var E=new Date();E.setTime(E.getTime()+F*1000);F=A.expires=E;}if(F&&F.toUTCString){A.expires=F.toUTCString();}C=encodeURIComponent(C);var y=z+"="+C;var B;for(B in A){if(A.hasOwnProperty(B)){y+="; "+B;var D=A[B];if(D!==true){y+="="+D;}}}c.document.cookie=y;}function r(){var y=parseInt(q("playerVolume"),10);if(isNaN(y)||y<0||y>100){y=50;}return y;}var p;var k=new Date();function m(y){if(p){c.clearTimeout(p);p=null;}p=c.setTimeout(function(){u("playerVolume",y,{expires:(new Date()).setFullYear(k.getFullYear()+1)});},25);}}function a(){var i=false;try{var j=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(j){i=true;}}catch(k){if(navigator.mimeTypes["application/x-shockwave-flash"]!==f){i=true;}}return !!i;}})(window);(function(a,c){var b=a.$;if(typeof(b)==="function"&&typeof(VK)!=="undefined"){b(function(){var d="http://radio.romanziva.ru/";VK.init({apiId:2859319,onlyWidgets:true});VK.Widgets.Like("vk_like",{type:"mini",height:18,pageUrl:d});VK.Widgets.Comments("vk_comments",{limit:10,width:"500",attach:"*",pageUrl:d});});}})(window);